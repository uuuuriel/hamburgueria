import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import br.com.hamburgueria.exception.NoResultException;
import br.com.hamburgueria.jdbcinterface.TaxaDAO;
import br.com.hamburgueria.objs.Taxa;
import br.com.hamburgueria.objs.Usuario;

public class JDBCTaxaDAO implements TaxaDAO {
	private Connection conexao;

	public JDBCTaxaDAO(Connection conexao) {
		this.conexao = conexao;
	}
	
	@Override
	public List<Taxa> buscar(String nome) throws NoResultException  {
		String comando = "select * from taxas  ";
		if (!nome.equals("")) {
			comando += "where taxa like '" + nome + "%'";
		}
		List<Taxa> list = new ArrayList<Taxa>();
		Taxa taxa = null;
		try {
			java.sql.Statement stmt = conexao.createStatement();
			ResultSet rs = stmt.executeQuery(comando);
			while (rs.next()) {
				taxa = new Taxa();
				taxa.setCod(rs.getInt("codtaxas"));
				taxa.setDescricao(rs.getString("descricao"));
				taxa.setNome(rs.getString("nometaxa"));
				taxa.setValor(rs.getInt("valor"));
				list.add(taxa);
			}
			if(list.isEmpty()){
				throw new NoResultException();
			}
		} catch (SQLException e) {
			e.printStackTrace();
		}
		return list;
	}
}